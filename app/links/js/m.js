let nodes,edges,network,startpages=[],needsreset=!0,darkmode=$("body").hasClass("dark"),font_color=darkmode?"white":"#121212",bg_color=darkmode?"#121212":"#fbfaf942";const container=document.getElementById("container"),options={nodes:{shape:"dot",scaling:{min:20,max:30,label:{min:14,max:25,drawThreshold:9,maxVisible:100}},font:{size:14,color:font_color,face:"sans",background:bg_color}},interaction:{hover:!0,hoverConnectedEdges:!1,selectConnectedEdges:!0}};nodes=new vis.DataSet,edges=new vis.DataSet;let data={nodes:nodes,edges:edges},initialized=!1;function makeNetwork(){network=new vis.Network(container,data,options),bindNetwork(),initialized=!0}function resetNetwork(e){initialized||makeNetwork();const t=getNeutralId(e);startpages=[t],window.tracenodes=[],window.traceedges=[],nodes=new vis.DataSet([{id:t,label:wordwrap(decodeURIComponent(e),20),value:2,level:0,color:getColor(0),x:0,y:0,parent:t}]),edges=new vis.DataSet,data={nodes:nodes,edges:edges},network.setData(data),firstAction&&(expandNode(encodeURIComponent(tags[0])),firstAction=!1)}function addStart(e,t){if(needsreset)resetNetwork(e),needsreset=!1;else{const t=getNeutralId(e);startpages.push(t),nodes.add([{id:t,label:wordwrap(decodeURIComponent(e),20),value:2,level:0,color:getColor(0),x:0,y:0,parent:t}])}}function resetNetworkFromInput(){needsreset=!0;const e=document.getElementsByClassName("commafield")[0],t=getItems(e);t[0]?t.forEach(e=>getPageName(encodeURI(e)).then(addStart)):noInputDetected()}function randomReset(){needsreset=!0;const e=document.getElementsByClassName("commafield")[0];clearItems(e);const t=()=>{getRandomArticle().then(t=>{addStart(t),addItem(e,decodeURIComponent(t))})};if(Math.random()<.3)for(let e=0;e<=Math.ceil(2*Math.random());e+=1)try{setTimeout(t,1e3*e)}catch(e){}else t()}function resetNetworkFromJson(e){initialized||makeNetwork();const t=networkFromJson(e);nodes=t.nodes,edges=t.edges,startpages=t.startpages,network.setData({nodes:nodes,edges:edges}),startpages.forEach(e=>{addItem(document.getElementById("input"),nodes.get(e).label)})}
